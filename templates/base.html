<!DOCTYPE html>
<html lang="en">

<head>
    <title>{% block title %}{% endblock %}</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.11.0/umd/popper.min.js" integrity="sha384-b/U6ypiBEHpOf/4+1nzFpr53nxSS+GLCkfwBdFNTxtclqqenISfwAzpKaMNFNmj4" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.0/css/bootstrap.min.css">
    <link rel='stylesheet' href='../static/css/main.css'>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.0/js/bootstrap.min.js"></script>
    <link href="https://fonts.googleapis.com/css?family=Roboto+Slab" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Nanum+Gothic" rel="stylesheet">
</head>

<body>

  <div id='nav-panel'>
    <a href='/'>
      <img src='../static/CN_Logo.png' height='30px' style='margin-left:80px; margin-top:24px;'></img>
    </a>
    <a class='btn btn-light submit-button' href='/submit'>Submit</a>
  </div>

  {% block content %}

  {% endblock %}

  <footer class="footer">
      <p>&copy; ScriptEd 2018</p>
  </footer>


</body>


  <script>
    function badgeClicked(num) {
      document.getElementById(num).childNodes[1].classList.toggle('cross-clicked');
      var tagName = document.getElementById(num).classList[4];
      // user selected tag
      if (document.getElementById(num).classList.contains('tag-unclicked')) {
          document.getElementById(num).classList.toggle('tag-unclicked');
          document.getElementById(num).style.backgroundColor = document.getElementById(num).classList[3];
          var numSelected = returnTagCount();
          // if the first tag is selected, make all invisible and grab tagged items
          if (numSelected == 1) {
            makeAllInvisible();
            console.log(tagName);
            var taggedProjects = document.getElementsByClassName('project '+tagName);
            console.log(taggedProjects);
            for (var i = 0; i < taggedProjects.length; i++) {
              taggedProjects[i].classList.remove('d-none');
            }
          }
          else {
            var tags = getFilteredTagNames();
            var classString = "";
            for (var i = 0; i < tags.length; i++) {
              classString += tags[i] + " ";
            }
            makeAllInvisible();
            var toFilter = document.getElementsByClassName(classString);
            for (var i = 0; i < toFilter.length; i++) {
              toFilter[i].classList.remove('d-none');
            }
          }
      }
      // user unselected tag
      else {
        document.getElementById(num).style.backgroundColor = '#a0a0a0';
        document.getElementById(num).classList.toggle('tag-unclicked');
        var numSelected = returnTagCount();
        if (numSelected == 0) {
          makeAllVisible();
        }
        else {
            var tags = getFilteredTagNames();
            var classString = "";
            for (var i = 0; i < tags.length; i++) {
              classString += tags[i] + " ";
            }
            makeAllInvisible();
            var toFilter = document.getElementsByClassName(classString);
            for (var i = 0; i < toFilter.length; i++) {
              toFilter[i].classList.remove('d-none');
            }

        }
      }

    }

    function makeAllInvisible() {
      var allProjects = document.getElementsByClassName('project');
      for (var i = 0; i < allProjects.length; i++) {
        allProjects[i].classList.add('d-none');
      }
    }

    function makeAllVisible() {
      var allProjects = document.getElementsByClassName('project');
      for (var i = 0; i < allProjects.length; i++) {
        allProjects[i].classList.remove('d-none');
      }

    }


    function returnTagCount() {
      var i = 1;
      var count = 0;
      currentElement = document.getElementById(i);
      while (currentElement){
        if (!currentElement.classList.contains('tag-unclicked')) {
          count = count + 1;
        }
        i += 1;
        currentElement = document.getElementById(i);
      }
      return count;
    }
    function getFilteredTagNames() {
      var i = 1;
      currentElement = document.getElementById(i);
      var out = [];
      while (currentElement){
        if (!currentElement.classList.contains('tag-unclicked')) {
          var name = currentElement.classList[4];
          out.push(name);
        }
        i += 1;
        currentElement = document.getElementById(i);
      }
      return out;
    }
  </script>

</html>
